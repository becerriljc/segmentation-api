# ------------------------------------------------------------------------------------------------------------#
#                                                 Libraries                                                   #
# ------------------------------------------------------------------------------------------------------------#
import uvicorn
from fastapi import FastAPI, Depends
from fastapi.middleware.cors import CORSMiddleware

# ------------------------------------------------------------------------------------------------------------#
#                                                Dependencies                                                 #
# ------------------------------------------------------------------------------------------------------------#

from .dependencies import get_auth_header

# ------------------------------------------------------------------------------------------------------------#
#                                                    Routes                                                   #
# ------------------------------------------------------------------------------------------------------------#
from .routes.dogs import router as routerDogs

# ------------------------------------------------------------------------------------------------------------#
#                                          Constants and Variables                                            #
# ------------------------------------------------------------------------------------------------------------#

baseUrl = '/api/v1/segmentation'

app = FastAPI(
    dependencies=[Depends(get_auth_header)],
)

# ------------------------------------------------------------------------------------------------------------#
#                                                Development                                                  #
# ------------------------------------------------------------------------------------------------------------#

app.add_middleware(
    CORSMiddleware,
    allow_credentials=True,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"],
)

app.include_router(
    routerDogs,
    prefix=baseUrl,
    tags=['segmentation'],
)

if __name__ == "__main__":
    # Use Uvicorn to serve the application
    uvicorn.run(app, host="0.0.0.0", port=8000)